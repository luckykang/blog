---
layout: post
title: 深度学习与机器视觉系列02丨深度学习与TensorFlow介绍与使用(二)
tag: 深度学习与机器视觉
---

## 一.会话Session

### 1.__init__(target='', graph=None, config=None)

一个运行TensorFlow operation的类。会话包含以下两种开启方式:

- tf.compat.v1.Session：用于完整的程序当中
- tf.InteractiveSession：用于交互式上下文中的TensorFlow ，例如shell

会话可能拥有的资源，如 tf.Variable，tf.QueueBase和tf.ReaderBase。当这些资源不再需要时，释放这些资源非常重要。因此，需要调用tf.Session.close会话中的方法，或将会话用作上下文管理器。

![20211128211317](https://cdn.jsdelivr.net/gh/luckykang/picture_bed/blogs_images/20211128211317.png)

**target：**

如果将此参数留空（默认设置），会话将仅使用本地计算机中的设备。可以指定 grpc:// 网址，以便指定 TensorFlow 服务器的地址，这使得会话可以访问该服务器控制的计算机上的所有设备。

**graph：**

默认情况下，新的 tf.compat.v1.Session 将绑定到当前的默认图。

**config：**

此参数允许指定一个 tf.ConfigProto 以便控制会话的行为。例如，ConfigProto协议用于打印设备使用信息。device_type：类型设备（例如CPU，GPU，TPU）

![20211128211850](https://cdn.jsdelivr.net/gh/luckykang/picture_bed/blogs_images/20211128211850.png)

### 2.会话的run()

- 通过使用sess.run()来运行operation
- fetches：单一的operation，或者列表、元组(其它不属于tensorflow的类型不行)
- feed_dict：参数允许调用者覆盖图中张量的值，运行时赋值
  - 与tf.compat.v1.placeholder搭配使用，则会检查值的形状是否与占位符兼容

**sess.run()、.eval()用法**

除了`sess.run`外，`.eval()`可以直接获取执行结果，但是必须在Session会话中执行。

    import tensorflow as tf
    import os
    os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'

    def session_demo():
        a_t = tf.constant(10)
        b_t = tf.constant(20)
        c_t = tf.add(a_t, b_t)
        # 开启会话
        with tf.compat.v1.Session() as sess:
            # sum_t = sess.run(c_t)
            # 同时执行多个tensor
            print(sess.run([a_t, b_t, c_t]))
            print("在sess当中的sum_t:\n", c_t.eval())

    if __name__ == '__main__':
        session_demo()

**tf.compat.v1.placeholder用法演示**

可以在运行时填充数据，通过feed_dict。用处主要是图已经定义好，数据还没有固定，在运行时每次填充计算。

    import tensorflow as tf
    import os
    os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'

    def session_demo():

        # 定义两个placeholder，用于占位
        plt_one = tf.compat.v1.placeholder(dtype=tf.float32)
        plt_two = tf.compat.v1.placeholder(dtype=tf.float32)
        plt_add = tf.add(plt_one, plt_two)
        # 开启会话
        with tf.compat.v1.Session() as sess:
            res = sess.run(plt_add, feed_dict={plt_one: 3, plt_two: 2})
            print(res)

    if __name__ == '__main__':
        session_demo()

## 二.张量Tensor

### 1.介绍

TensorFlow 的张量就是一个 n 维数组， 类型为tf.Tensor。Tensor具有以下两个重要的属性

- type:数据类型
- shape:形状(阶)

### 2.张量的类型

![20211128233228](https://cdn.jsdelivr.net/gh/luckykang/picture_bed/blogs_images/20211128233228.png)

