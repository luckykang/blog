---
layout: post
title: 深度学习与机器视觉系列01丨深度学习与TensorFlow介绍与使用
tag: 深度学习与机器视觉
---

## 一.深度学习介绍

![20211111104731](https://cdn.jsdelivr.net/gh/luckykang/picture_bed/blogs_images/20211111104731.png)


### 1.深度学习与机器学习的区别

#### （1）特征提取方面

- 机器学习

机器学习的特征工程要靠手动完成，而且需要大量领域专业知识

- 深度学习

通常由多个层组成，它们通常将更简单的模型组合在一起，通过将数据从一层传递到另一层来构建更复杂的模型。通过大量数据的训练自动得到模型，不需要人工设计特征提取环节

#### （2）数据量

- 机器学习

参数较少，执行时间短

- 深度学习

参数庞大，执行时间长，需要通过大量数据的多次优化来训练参数

第一、它们需要大量的训练数据集

第二、是训练深度神经网络需要大量的算力

可能要花费数天、甚至数周的时间，才能使用数百万张图像的数据集训练出一个深度网络。所以

> 需要强大的GPU服务器来进行计算

> 全面管理的分布式训练与预测服务——比如谷歌 TensorFlow 云机器学习平台,可能会解决这些问题

### 2.各自的算法代表

- 机器学习

朴素贝叶斯、决策树

- 深度学习

神经网络

### 3.应用场景

- 图像识别领域：包括物体识别、场景识别、车型识别、人脸检测跟踪、人脸关键点定位、人脸身份认证等

- 自然语言处理：机器翻译、文本识别、聊天对话等

- 语音技术:语音识别

## 二.TensorFlow介绍

### 1.TensorFlow的特点

- 语言多样

C++实现，用python封装的，支持多语言接口

- 使用分发策略进行分发训练
  
对于大型ML训练任务，分发策略API使得在不更改模型定义的情况下，可以轻松的在不同的硬件配置上分发和训练模型。支持一系列硬件加速器，如CPU、GPU和TPU。

- Tensorboard可视化

Tensorboard是TensorFlow的一组Web应用，用来监控TensorFlow运行过程

- 在任何平台上的生产中进行强大的模型部署

训练完成并保存了模型，就可以直接在应用程序中执行，或者使用部署库为其提供服务：

> TensorFlow服务: 允许模型通过HTTP/REST或GRPC/协议缓冲区提供服务的TensorFlow库构建。

> TensorFlow Lite: TensorFlow针对移动端和嵌入式设备的轻量级解决方案，提供了在Android、ios和嵌入式系统上部署模型的能力。

> Tensorflow.js: 支持在JavaScript环境中部署模型，例如在web浏览器或服务端通过Node.js部署模型。还支持在JavaScript中定义模型，并使用类似于Kera的API直接在web浏览器中进行训练。

### 2.TensorFlow的安装

我这里用的是1.12版本，安装完成后会有两个package

tensorboard           1.12.2

tensorflow            1.12.0

### 3.TensorFlow使用技巧

- 使用`tf.keras`构建、训练和验证模型，tf相关API用于损失计算修改等。

- tensorflow提供模型训练、模型部署

## 三.TensorFlow结构

### 1.实现一个加法

    import tensorflow as tf
    import os
    os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'

    # 实现加法
    a = tf.constant(11)
    b = tf.constant(20)
    c = tf.add(a, b)
    print(c.graph)

    # 开启会话，才会运行
    with tf.Session() as sess:
        sum_tf = sess.run(c)
        print("在sess中的值为：", sum_tf)

运行结果：

![20211112173953](https://cdn.jsdelivr.net/gh/luckykang/picture_bed/blogs_images/20211112173953.png)

**如果遇到报错：**

`I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2`

意思是 CPU 支持AVX2 FMA（加速CPU计算），但安装的 TensorFlow 版本不支持

**解决办法：**

（1）如果没有太大计算速度的需求，可以加两行代码忽略

    import os
    os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'

（2）如果有需要优化CPU，可以重新编译tensorflow源码以兼容AVX。

可参考link: [https://github.com/lakshayg/tensorflow-build](https://github.com/lakshayg/tensorflow-build)

### 2.结构分析

TensorFlow 程序通常被组织成**一个构建图阶段**和**一个执行图阶段**。

在构建阶段，数据与操作的执行步骤被描述成一个图。

在执行阶段，使用会话执行构建好的图中的操作。

- 图和会话 ：
    - 图（graph）：这是 TensorFlow 将计算表示为指令之间的依赖关系的一种表示法
    - 会话（session）：TensorFlow 跨一个或多个本地或远程设备运行数据流图的机制
- 张量（tensor）：TensorFlow 中的基本数据对象
- 节点（Operation）：提供图当中执行的操作

### 3.数据流图介绍

![20211112180618](https://cdn.jsdelivr.net/gh/luckykang/picture_bed/blogs_images/20211112180618.png)

TensorFlow是一个采用数据流图（data flow graphs），用于数值计算的开源框架。

节点（Operation）在图中表示数学操作，线（edges）则表示在节点间相互联系的多维数据数组，即张量（tensor）。

## 四.图与TensorBoard

### 1.什么是图结构

图包含了一组tf.Operation代表的计算单元对象和tf.Tensor代表的计算单元之间流动的数据。

### 2.图相关操作



